import asyncio

from telethon import events
from telethon.errors import UserNotParticipantError
from telethon.tl.functions.channels import GetParticipantRequest
from telethon.tl.types import ChannelParticipantAdmin, ChannelParticipantCreator
import random
from ArankBabess import telethn as client

spam_chats = []

EMOJI = [ "??????????",
          "???Œ¸???¬??",
          "???Œ·?Œ¹?Œº??",
          "?Œ¸?Œ¿?’®?Œ±?Œµ",
          "?¤ï????????–¤",
          "??????????",
          "?Œ¸???Œº?Œ¹??",
          "???¦ª???²??",
          "?????????Œ¶ï¸?",
          "???¥¤?????·",
          "?¬?­?????¡",
          "?¨???º?•ð??,
          "?¥ª?¥§?¦?¥??",
          "???•ð?¹ð?·ðŸ¥?,
          "?•ðŸ§ƒð?©ð?¦ð??,
          "???Œ¾?’®???Œ¿",
          "?Œ¨ï¸ð?¥ï??ˆï??Œ©ï¸ð?§ï?",
          "?Œ·?µï¸ð?¸ð?ºð??,
          "?’®?Œ¼?Œ»????",
          "???¦¸?¦¹???‘¸",
          "???????Œ½?¥¦",
          "?·?¹?­?¨?»?â?ï¸?,
          "???????????â?",
          "?Œ¼?Œ³?Œ²?Œ´?Œµ",
          "?¥©????????",
          "?´?½ï¸ð?ªð?¶ðŸ¥?,
          "???°?©?©ï??©",
          "??????????",
          "?ª´?Œµ?Œ´?Œ³?Œ²",
          "??????????",
          "??????ï¸ðŸ¦¤ðŸ¦?,
          "?¦¤?¦©??????",
          "?¬?¦­?????³",
          "???????¡??",
          "?¦©???????¦ª",
          "?¦???•·ï¸ð?¸ï???",
          "?¥ª?°?¥§?¨?¨",
          " ?¥¬??????",
        ]
          
TAGMES = [ " **?????² ???????² ?????¡?? ???¨?¥±** ",
           " **???²?? ???¨ ???²?? ???²?? ???§?¥?¢?§?? ?????¨??** ",
           " **???? ???¡???¥?¨ ?????­???§ ?????«?­?? ?????¢?§ ???®???¡ ???®???¡??** ",
           " **???¡???§?? ???¡?? ???¢?²?? ???¢..???¥²** ",
           " **???¡???« ???? ?????? ?????¢?¬?? ?????¢?§ ???¢?¥º** ",
           " **???­?? ?????¢ ???¨?¡?¨?­ ???¢?¬?¬ ?????« ???¡?¢ ???¡?¢ ?????©?¤?¨?¤­** ",
           " **???²?? ?????¥ ???¡???¥ ?????¬?? ?????¢..???¤¨** ",
           " **?????«?¢ ???¡?¢ ?????­?­?¢?§?? ?????«???? ???¨????..????** ",
           " **?????©?¤?? ?????¦?? ???²?? ?¡???¢..???¥²** ",
           " **?????¬?­?? ???®?? ?????©?¤??..????** ",
           " **?????«?? ???¨ ???©?§?? ???«?¨?®?© ???? ???¢???§???© ???« ???¨??** ",
           " **?????©?¤?¢ ?????«?­?§???« ?????©?¤?¨ ???¡?®?§?? ???¡?? ?????¢?§ ???¥???¢ ???§?¥?¢?§?? ???²?¢????????** ",
           " **?????«?? ???? ???¨?¬?­?¢ ???«?¨????..????** ",
           " **???¨?§?? ???¡???¥ ???²?? ???²??????** ",
           " **???¤ ???¨?§?? ???¥???² ???«?¨ ???? ???¥?¬?¬??** ",
           " **?????© ?????¡?? ???? ???¨..????** ",
           " **?????¥?¥?¨ ???¢ ?????¦???¬?­????** ",
           " **?????¥?¥?¨ ???????² ???¤?«?¡..???** ",
           " **???¨ ???¨?® ???§?¨?° ???¡?¨ ???¬ ???² ???°?§???«.?** ",
           " **???¡?¥?¨ ???®???¡ ?????¦?? ???¡???¥?­?? ?????¢?§.??** ",
           " **???®?« ?????­???¨ ?????¢?¬?? ???¨ ???????²??** ",
           " **???®?¦?¡???«?¢ ???®?¦?¦?² ???²?? ?????« ?????¡?¢ ?????¢?¤­** ",
           " **?????«?? ???? ?????­ ???¨?¢ ???«?¨?????¥º?¥º** ",
           " **???²?? ?????????¥ ???§?¥?¢?§?? ???? ?????˜¶** ",
           " **?????£ ???¨?¥?¢?????² ?????¢ ???²?? ?????¡?¨?¨?¥ ????..????** ",
           " **???²?? ???¨?¨?? ???¨?«?§?¢?§????** ",
           " **???®?§?¨ ???¤ ?????¦ ?????¢ ???®?¦?¬????** ",
           " **???¨?¢ ???¨?§?? ???¥???² ???«?¨ ?????˜ª** ",
           " **???¢???? ???¨ ???????­ ???¡??* ",
           " **?????¥?¥?¨??** ",
           " **???­?®???² ???¨?¦?¥???­?? ???®?????˜º** ",
           " **???¨?¥?¨ ???? ???®???¡ ???«?«?¥²** ",
           " **???¨?§???¥?¢ ???¨?§ ?????¢...????** ",
           " **???®?¦?¡???«?¢ ???¤ ???¢?? ???¢?¥?????¢..???** ",
           " **???®?¦?¦?² ???? ???²?¢ ???²????????** ",
           " **???« ?????­???¨ ???¡?????¡?¢ ?????¢?¬?¢ ?????¢??** ",
           " **?? ???¨?¯?? ???¨?®??????** ",
           " **???¨ ???¨?® ???¨?¯?? ????..???** ",
           " **?????¤?¡?¢ ?????? ?????§?? ?????¡?¢ ???¨.????** ",
           " **???¤ ???¨?§?? ???®?§???®..??˜¹** ",
           " **???§?¥?¢?§?? ???? ???? ???? ???¨?§?? ???®?§?? ?????¡?¢ ???®?˜»** ",
           " **???§?¬?­?????«???¦ ???¡???¥???­?? ???¨..????** ",
           " **???¡???­?¬???©?© ???®?¦?????« ???¨???? ???©?§?? ???®?¦..???** ",
           " **???®?¦?¡?? ???¨?§ ???? ???®?¬?¢?? ???®?§?§?? ?????¬???§?? ?????¢..???** ",
           " **?????«?? ?????¦ ???¡???­???¦ ???¨ ???²?? ?????©?¤??..???** ",
           " **?????¡?? ???? ???¨ ?????©??** ",
           " **???®?§?¨ ??????** ",
           " **?????«?? ???¤ ???????¦ ?????« ???¨????..?** ",
           " **???² ?????­?? ?????­ ?????­ ?????«?§?? ?????£ ???? ????????** ",
           " **???¨?¦ ?????? ?????¢?¬?? ?????¢?§..???* ",
           " **???²?? ???®??..??‘±** ",
           " **???¨?¡?¨?­ ???????? ???? ???¡?¢ ?????¢ ?¤§???** ",
           " **???¡?®?¥ ???²?? ???®?£?¡??????** ",
           " **???®?­?¡ ???¡?¢ ???¨?¥?§?? ???¡???¡?¢?²????** ",
           " **???¡?? ???¨ ???¡???° ?????­ ???«?¨ ???????­??** ",
           " **???²?? ???®???˜®?˜®** "
           " **???¢?¢??** ",
           " **?????©?¤?? ?????¢?¬?? ???¨?¬?­ ???¨ ?????­?¡ ???? ???¢?« ???®?¦ ???¢?¬ ?????­ ???? ??** ",
           " **?????£ ?????¢ ?????? ???® ?¹ï?** ",
           " **???®?¬?£?¡?¬?? ???¡?¢ ?????­ ?????« ???¨ ???? ?¥º?¥º** ",
           " **???²?? ?????« ?????¡?? ???¨??** ",
           " **???²?? ?????¥ ???¡???¥ ?????¢ ??** ",
           " **?????¡?? ???? ???¨ ?????©..???** ",
           " **???¡???­?­?¢?§?? ?????« ???¨ ????..?¥º** ",
           " **???? ?????¬?¨?¨?¦ ???® ?????¥º?¥º** ",
           " **?????¥ ?????£?? ???²?? ???¡?? ?????¤­??** ",
           " **???«?¨?®?© ???? ?????­ ???²?® ?????¡?¢ ?????«?­?? ???¨??** ",
           " **?????© ?????¥???­?¢?¨?¦?¬?¡?¢?© ???? ???¨..???** ",
           " **???¢?­?§?? ???¡?®?© ?????¡?­?? ???¨ ???«?«?˜¼** ",
           " **?????©?¤?¨ ?????§?? ?????§?? ?????­?? ?????¢..??˜¸** ",
           " **???¡?®?¦?§?? ???¡???¥?¨????..????** ",
           " **???¡?®?¬ ?????¡?? ?????«?¨ ?Œï???** ",
           " **?????¦ ???¨?¬?­ ?????§ ?????¤?­?? ?????¢...??¥°** ",
           " **???®???¡ ???¨?¥ ???²?® ???¡?¢ ?????¡?? ???¨..?¥º?¥º** ",
           " **???®???¡ ?????¦?????«?¬ ?????? ?????« ???¨ ?¥²** ",
           " **???¢?§???¥?? ???¨ ???? ???¢?§???¥?? ??** ",
           " **?????¨ ?????«?­?² ?????«?­?? ?????¢?§???¥³** ",
           " **?????¦?¥?¨?¨??** ",
           " **???®?£?¡?? ???¡?®?¥ ???²?? ???²???¥º** ",
           " **?????¡?? ???? ?????¨:- [ @TG_FRIENDSS ] ?????¬?­?¢ ?????«???§???? ?¤­?¤­** ",
           " **???«?®?­?¡ ???§?? ?????«?? ???¡???¥?¨????..? ??** ",
           " **?????£ ???®?¦?¦?² ???? ?????­?? ???«?¥º?¥º** ",
           " **???¨?¢?§ ?????« ???¨:- [ @VIP_CREATORS ] ??** ",
           " **???¤ ???¢?¥ ?????¢ ???¤ ???¢?¥ ???¢ ???¨ ?????¢????** ",
           " **???®?¦?¡???«?? ???¨?¬?­ ?????¡?? ???²???¥º** ",
           " **???² ???®?­?? ???°?§???« [ @Arank_Music ]?¥°** ",
           " **?????¡?? ???¡?¨?²?? ???¨ ???????§??** ",
           " **???¨?¨?? ??8 ???¢ ???¡?®?­ ?????­ ???¨ ???²?¢?¥°** ",
           ]

         

@client.on(events.NewMessage(pattern="^/tagall ?(.*)"))
@client.on(events.NewMessage(pattern="^@all ?(.*)"))
@client.on(events.NewMessage(pattern="^#all ?(.*)"))
@client.on(events.NewMessage(pattern="^#tag ?(.*)"))
@client.on(events.NewMessage(pattern="^/utag ?(.*)"))
@client.on(events.NewMessage(pattern="^@utag ?(.*)"))
@client.on(events.NewMessage(pattern="^#utag ?(.*)"))
async def mentionall(event):
    chat_id = event.chat_id
    if event.is_private:
        return await event.respond(
            "__This command can be use in groups and channels!__"
        )

    is_admin = False
    try:
        partici_ = await client(GetParticipantRequest(event.chat_id, event.sender_id))
    except UserNotParticipantError:
        is_admin = False
    else:
        if isinstance(
            partici_.participant, (ChannelParticipantAdmin, ChannelParticipantCreator)
        ):
            is_admin = True
    if not is_admin:
        return await event.respond("???§?¥?² ?????¦?¢?§ ?????§ ?????§?­?¢?¨?§ ???¨ ???¥?¥ ???????²...")

    if event.pattern_match.group(1) and event.is_reply:
        return await event.respond("/tagall hello ?? ???²?©?? ???¢?¤?? ???¡?¢?¬ ?????±?­ ???¢?¦?? ???¤ ???¨?« ?????????¢?§??..")
    elif event.pattern_match.group(1):
        mode = "text_on_cmd"
        msg = event.pattern_match.group(1)
    elif event.is_reply:
        mode = "text_on_reply"
        msg = await event.get_reply_message()
        if msg == None:
            return await event.respond(
                "/tagall hii ?? ???²?©?? ???¢?¤?? ???¡?¢?¬ ???« ?????©?¥?² ???§?² ?????¬?¬??????..."
            )
    else:
        return await event.respond(
            "/tagall hii ?? ???²?©?? ???¢?¤?? ???¡?¢?¬ ???« ?????©?¥?² ???§?² ?????¬?¬??????..."

        )

    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.iter_participants(chat_id):
        if not chat_id in spam_chats:
            break
        usrnum += 1
        usrtxt += f"[ {usr.first_name} ](tg://user?id={usr.id}) "
 
        if usrnum == 1:
            if mode == "text_on_cmd":
                txt = f"{usrtxt} {random.choice(TAGMES)}"
                await client.send_message(chat_id, txt)
      

            elif mode == "text_on_reply":
                await msg.reply(f"[ {random.choice(EMOJI)} ](tg://user?id={usr.id})")
            await asyncio.sleep(2)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass


@client.on(events.NewMessage(pattern="^/cancel$"))
@client.on(events.NewMessage(pattern="^/stop$"))
async def cancel_spam(event):
    if not event.chat_id in spam_chats:
        return await event.respond("?????«?? ???¨ ???§?² ?????§?­?¢?¨?§ ???«?¨?????¬?¬ ???¬ ???­???«?­???? ???² ????..")
    is_admin = False
    try:
        partici_ = await client(GetParticipantRequest(event.chat_id, event.sender_id))
    except UserNotParticipantError:
        is_admin = False
    else:
        if isinstance(
            partici_.participant, (ChannelParticipantAdmin, ChannelParticipantCreator)
        ):
            is_admin = True
    if not is_admin:
        return await event.respond("???¡?¢?¬ ???¨?¦?¦???§?? ???¬ ???§?¥?² ???¨?« ?????¦?¢?§?¬.. ???¨?® ?????§'?­ ???¬?? ???¡?¢?¬ ???¨?¦?¦???§??..")

    else:
        try:
            spam_chats.remove(event.chat_id)
        except:
            pass
        return await event.respond("?¦ð?’ð?­ð?¨ð?©ð?©ð?žð???????§?­?¢?¨?§ ???????²??)


__mod_name__ = "?¡Tá´€É¢??
__help__ = """
?€?€?? á´É´ÊŸÊ??á´Ê€ á´€á´…á?ÉªÉ´s ?â??€

??/á´›á?É¢á´€?? , #tag , .tagmember , @á´€?? , #all '(?á´‡á??? á´›á? á´á?ssá´€É¢á´?á´Ê€ á´€á´…á? á´€É´á´á??á´‡Ê€ á´á?ssá´€É¢á´? á´›á? á´á?É´á´›Éªá?É´ á´€?? á´á?á´Ê™á??s ÉªÉ´ ?á´á?? É¢?á´á?á´? á´¡Éªá??á´á?á´?á´‡xá´„á?á´˜á?Éªá´É?'
??/cancel ?á´Ê€ á´„á?É´á´„á?? á´›Êœá? É¢á´ÉªÉ´É?á´›á?É¢É¢ÉªÉ´É¢
??...........?™±?? Â» [???™¸?™¿ ?™±?™¾??](https://t.me/Arank_Music)............??"""
